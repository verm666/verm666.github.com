<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">Recent Blog Posts</title>
  <id>http://verm666.github.com/feed.atom</id>
  <updated>2012-01-15T00:00:00Z</updated>
  <link href="http://verm666.github.com/" />
  <link href="http://verm666.github.com/feed.atom" rel="self" />
  <subtitle type="text">Recent blog posts</subtitle>
  <generator>Werkzeug</generator>
  <entry xml:base="http://verm666.github.com/feed.atom">
    <title type="text">Приватный репозиторий OBS</title>
    <id>http://verm666.github.com/2012/01/15/stand_alone_OBS</id>
    <updated>2012-01-15T00:00:00Z</updated>
    <link href="http://verm666.github.com/2012/01/15/stand_alone_OBS" />
    <author>
      <name>verm666</name>
    </author>
    <content type="html">&lt;div class="section" id="id1"&gt;
&lt;h2&gt;Вступление&lt;/h2&gt;
&lt;p&gt;После того, как в субботу вечером в очередной раз build.opensuse.org лег и начал
отдавать на все запросы 503 терпение закончилось и было решено отвязаться
от внешнего сервиса окончательно.&lt;/p&gt;
&lt;p&gt;В wiki проекта можно найти несколько упоминаний о том, как это можно сделать. Но
на примере rpm-based дистрибутивов. И ни одного примера для Debian. Ниже будет
описано как это сделать для Debian 6.0 (x86_64).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="forever-alone"&gt;
&lt;h2&gt;Forever alone&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Создаем новый проект в OBS (Debian);&lt;/li&gt;
&lt;li&gt;Создаем в нем подпроект (6:0);&lt;/li&gt;
&lt;li&gt;Вносим изменения в Raw config проекта (Project-&amp;gt;Advanced-&amp;gt;Raw Config);&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;project&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Debian:6.0&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;title&amp;gt;&lt;/span&gt;6.0&lt;span class="nt"&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;description/&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;person&lt;/span&gt; &lt;span class="na"&gt;role=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;maintainer&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;userid=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;verm666&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;person&lt;/span&gt; &lt;span class="na"&gt;role=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;bugowner&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;userid=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;verm666&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;repository&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;standard&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;arch&amp;gt;&lt;/span&gt;x86_64&lt;span class="nt"&gt;&amp;lt;/arch&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/project&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Заливаем projconf (Projct-&amp;gt;Advanced-&amp;gt;Project Config);&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Именно из-за этого пункта я пишу эту заметку. Т.к. готового конфига в rpm
пакетах OBS нет (если для Lenny, но он немного не работает),
а при лежащем build.opensuse.org искать его, по факту, негде.&lt;/p&gt;
&lt;p&gt;Мой projconf для Debian_6.0 можно взять &lt;a class="reference external" href="/static/my/Debian_6.0_prjconf.txt"&gt;тут&lt;/a&gt;.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Заходим на сервер по ssh и создаем директорию для бинарных пакетов нашего проекта:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# mkdir -p /srv/obs/build/Debian\:6.0/standard/x86_64/\:full/
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Кладем в эту директорию все пакеты для Debian Squeeze x86_64
(я использовал debmirror);&lt;/p&gt;
&lt;p&gt;Индексируем проект:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# /usr/lib/obs/server/bs_admin --rescan-repository Debian:6.0 standard x86_64
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Смотрим логи obsscheduler'а:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# tail -f /srv/obs/log/scheduler_x86_64.log
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h2&gt;Сборка пакетов&lt;/h2&gt;
&lt;p&gt;Для сборки своих пакетов создается отдельный репозиторий и подключается как
build target через advanced interface (Or pick one via advanced interface. На
странице с репозиториями проекта)&lt;/p&gt;
&lt;p&gt;Hint: В 'New name' лучше указывать Debian_6.0 (такое же название, какое
используется при работе с внешним OBS. Таким образом после отключения внешнего
OBS ссылки на репозиторий с deb пакетами останутся прежними и вам не придется
вносить изменения в sources.list)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h2&gt;Ссылки по теме&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://en.opensuse.org/openSUSE:Build_Service_prjconf"&gt;http://en.opensuse.org/openSUSE:Build_Service_prjconf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://en.opensuse.org/openSUSE:Build_Service_adding_build_targets"&gt;http://en.opensuse.org/openSUSE:Build_Service_adding_build_targets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://en.opensuse.org/openSUSE:Build_Service_private_instance_boot_strapping"&gt;http://en.opensuse.org/openSUSE:Build_Service_private_instance_boot_strapping&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content>
  </entry>
</feed>

